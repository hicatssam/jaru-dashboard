
ØªÙ…Ø§Ù…! ğŸ˜
Ø³Ø£Ø¯Ù…Ø¬ Ù„Ùƒ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„ØµÙØ­Ø© Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:

1. Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø¨Ø·Ø§Ù‚Ø§Øª ÙˆØ£ÙŠØ¶Ù‹Ø§ Ø¬Ø¯ÙˆÙ„.


2. ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹ Ù…Ø¹ ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† Ù…Ø¨Ø§Ø´Ø±Ø©.


3. ØªØµØ¯ÙŠØ± Excel Ø¨Ø¯ÙˆÙ† Ù…Ø´Ø§ÙƒÙ„.


4. Ø²Ø± Ø­Ø°Ù Ø·Ù„Ø¨ ÙˆØ§Ø­Ø¯ Ù…Ø¹ Alert Ø®Ø±Ø§ÙÙŠ ÙˆØ¬Ø°Ø§Ø¨.


5. Ø²Ø± Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù…Ø¹ Alert ØªØ­Ø°ÙŠØ±ÙŠ Ù…ØªÙ‚Ø¯Ù….


6. ØªØ£Ø«ÙŠØ±Ø§Øª ØªØµÙ…ÙŠÙ…ÙŠØ© Ø­Ø¯ÙŠØ«Ø© Ù„Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ù€ Alert.



Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø§Ù„Ù…Ø¯Ù…Ø¬:

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª - Ø§Ù„Ø¬Ø±Ùˆ | Order Details</title>
<style>
body { font-family: 'Cairo', sans-serif; background-color: #f4f4f9; margin:0; padding:0; color:#333; }
header { background-color: #FFC501; padding: 20px; text-align: center; position: relative; }
header h1 { margin:0; color:#222; font-size:32px; }
header img { height:60px; position:absolute; right:20px; top:15px; }
.lang-toggle { position:absolute; top:20px; left:20px; background:#fff; border:1px solid #ccc; border-radius:6px; padding:5px 10px; cursor:pointer; font-size:14px; }
.container { max-width:1200px; margin:0 auto; padding:20px; }
.card-orders { display:flex; flex-wrap:wrap; gap:20px; margin:30px 0; }
.order-card { background: linear-gradient(135deg, #fff8e1, #ffe082); border-radius:20px; padding:20px; box-shadow:0 4px 12px rgba(0,0,0,0.1); flex:1 1 calc(33.333% - 20px); min-width:280px; transition:0.3s ease; position: relative; }
.order-card:hover { transform: scale(1.02); box-shadow:0 6px 18px rgba(0,0,0,0.15); }
.order-card h3 {margin:0 0 10px; color:#222;}
.order-card p {margin:5px 0;}
.order-card .price {font-weight:bold; color:#e53935;}
.order-card .status, .payment-badge {padding:6px 12px; border-radius:20px; font-size:14px; font-weight:bold; display:inline-block; margin-top:10px;}
.order-card .status { background-color:#90caf9; color:#fff; }
.payment-badge.paid { background-color:#4caf50; color:#fff; }
.payment-badge.unpaid { background-color:#f44336; color:#fff; }
.order-card .new-badge { position: absolute; top: -10px; left: -10px; background-color: #e53935; color: #fff; font-size: 12px; font-weight: bold; padding: 6px 12px; border-radius: 50%; box-shadow: 0 2px 6px rgba(0,0,0,0.3); }
table { width:100%; border-collapse: collapse; background-color:#fff; border-radius:12px; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
th, td { padding:12px 10px; text-align:center; font-size:14px; word-wrap:break-word; }
th { background-color:#ffe082; color:#444; }
tr:nth-child(even) {background-color:#f9f9f9;}
select.payment-select { padding:5px; border-radius:6px; border:1px solid #ccc; cursor:pointer; }
.payment-badge-table.paid { background-color:#4caf50; color:#fff; padding:4px 10px; border-radius:12px; font-weight:bold; }
.payment-badge-table.unpaid { background-color:#f44336; color:#fff; padding:4px 10px; border-radius:12px; font-weight:bold; }
#exportExcelBtn, #deleteAllBtn { background: linear-gradient(135deg, #ff7e5f, #feb47b); color: #fff; border: none; padding: 12px 20px; font-size: 16px; border-radius: 10px; cursor: pointer; transition: transform 0.2s ease, box-shadow 0.2s ease; margin-bottom: 20px; }
#exportExcelBtn:hover, #deleteAllBtn:hover { transform: translateY(-3px); box-shadow:0 6px 18px rgba(0,0,0,0.3); }
.delete-btn { background: linear-gradient(135deg, #f44336, #e53935); color:#fff; border:none; padding:6px 12px; border-radius:8px; cursor:pointer; transition:0.2s; }
.delete-btn:hover { transform: scale(1.05); box-shadow:0 4px 12px rgba(0,0,0,0.3);}
footer { background-color:#333; color:white; text-align:center; padding:15px 0; margin-top:40px; }

/* Alert Ø®Ø±Ø§ÙÙŠ */
.alert-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.6); display:flex; align-items:center; justify-content:center; z-index:999; visibility:hidden; opacity:0; transition:0.3s ease; }
.alert-box { background:#fff; padding:30px 20px; border-radius:20px; text-align:center; max-width:400px; width:90%; box-shadow:0 15px 35px rgba(0,0,0,0.3); transform: scale(0.5); transition: transform 0.3s ease, opacity 0.3s ease; opacity:0;}
.alert-show .alert-box { transform: scale(1); opacity:1; }
.alert-box h3 { margin:15px 0 0; font-size:22px; color:#222; }
.alert-box button { margin:10px; min-width:100px; padding:12px 20px; border-radius:12px; font-weight:bold; cursor:pointer; transition:0.2s ease; border:none; }
.alert-box button:hover { transform: scale(1.05); }

@media (max-width: 992px) { .order-card { flex:1 1 calc(50% - 20px); } }
@media (max-width: 600px) { .order-card { flex:1 1 100%; } header h1 { font-size:24px; } th, td { font-size:12px; padding:8px; } #exportExcelBtn, #deleteAllBtn { font-size:14px; padding:10px 15px; } }
</style>
</head>
<body>

<header>
<img src="images/logo.svg.jpg" alt="Al Jarou Logo">
<h1 id="page-title">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª - Ø§Ù„Ø¬Ø±Ùˆ | Order Details</h1>
<button class="lang-toggle" onclick="toggleLang()">English</button>
</header>

<div class="container">
<h2 id="latest-title">Ø£Ø­Ø¯Ø« 3 Ø·Ù„Ø¨Ø§Øª | Latest 3 Orders</h2>
<div class="card-orders" id="latest-orders"></div>

<h2 id="all-title">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª | All Orders</h2>
<button id="exportExcelBtn">ØªØµØ¯ÙŠØ± Excel</button>
<button id="deleteAllBtn">Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</button>

<table>
<thead>
<tr>
<th id="th-customer">Ø§Ù„Ø²Ø¨ÙˆÙ† | Customer</th>
<th id="th-orders">Ø§Ù„Ø·Ù„Ø¨Ø§Øª | Orders</th>
<th id="th-total">Ø§Ù„Ù…Ø¨Ù„Øº | Total</th>
<th id="th-date">Ø§Ù„ØªØ§Ø±ÙŠØ® | Date</th>
<th id="th-payment">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹ | Payment</th>
<th id="th-payment-status">Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹ | Payment Status</th>
<th id="th-status">Ø§Ù„Ø­Ø§Ù„Ø© | Status</th>
<th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª | Actions</th>
</tr>
</thead>
<tbody id="table-orders"></tbody>
</table>
</div>

<footer>
<p id="footer-text">&copy; 2025 Al Jarou. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©. | All rights reserved.</p>
</footer>

<!-- Alert Ø®Ø±Ø§ÙÙŠ -->
<div id="alertOverlay" class="alert-overlay">
  <div class="alert-box">
    <div style="font-size:50px; color:#f44336;">âš ï¸</div>
    <h3 id="alertText">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ</h3>
    <div style="margin-top:20px;">
      <button id="confirmBtn" style="background: linear-gradient(135deg,#ff416c,#ff4b2b); color:#fff;">Ù†Ø¹Ù…</button>
      <button id="cancelBtn" style="background: linear-gradient(135deg,#ddd,#aaa); color:#333;">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyCEsjPeY7773MQeSyiL6M1n4RHRl5TGAyk",
  authDomain: "jaru-drinks.firebaseapp.com",
  projectId: "jaru-drinks",
  storageBucket: "jaru-drinks.appspot.com",
  messagingSenderId: "317969024088",
  appId: "1:317969024088:web:d99f66953f06572779f62d"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let orders = [];
let deleteTargetId = null;

// Alert Ø¹Ù†Ø§ØµØ±
const alertOverlay = document.getElementById("alertOverlay");
const alertText = document.getElementById("alertText");

function showAlert(text, orderId=null){
  deleteTargetId = orderId;
  alertText.textContent = text;
  alertOverlay.classList.add("alert-show");
}
function hideAlert(){ alertOverlay.classList.remove("alert-show"); deleteTargetId=null; }
document.getElementById("cancelBtn").onclick = hideAlert;
document.getElementById("confirmBtn").onclick = ()=>{
  if(deleteTargetId){ // Ø­Ø°Ù Ø·Ù„Ø¨ ÙˆØ§Ø­Ø¯
    db.collection("orders").doc(deleteTargetId).delete()
    .then(()=>{ orders = orders.filter(o=>o.id!==deleteTargetId); renderOrders(); hideAlert(); })
    .catch(err=>console.error(err));
  }
};

// Ø§Ù„Ù„ØºØ©
const translations = {
  ar: {pageTitle:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª - Ø§Ù„Ø¬Ø±Ùˆ", latest:"Ø£Ø­Ø¯Ø« 3 Ø·Ù„Ø¨Ø§Øª", all:"Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª", customer:"Ø§Ù„Ø²Ø¨ÙˆÙ†", orders:"Ø§Ù„Ø·Ù„Ø¨Ø§Øª", total:"Ø§Ù„Ù…Ø¨Ù„Øº", date:"Ø§Ù„ØªØ§Ø±ÙŠØ®", payment:"Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹", paymentStatus:"Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹", status:"Ø§Ù„Ø­Ø§Ù„Ø©", confirmed:"Ù…Ø¤ÙƒØ¯", canceled:"Ù…Ù„ØºÙŠ", paid:"Ù…Ø¯ÙÙˆØ¹", unpaid:"ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹", footer:"&copy; 2025 Al Jarou. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.", button:"English"},
  en: {pageTitle:"Order Details - Al Jarou", latest:"Latest 3 Orders", all:"All Orders", customer:"Customer", orders:"Orders", total:"Total", date:"Date", payment:"Payment Method", paymentStatus:"Payment Status", status:"Status", confirmed:"Confirmed", canceled:"Canceled", paid:"Paid", unpaid:"Unpaid", footer:"&copy; 2025 Al Jarou. All rights reserved.", button:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©"}
};
let currentLang = 'ar';
function toggleLang(){
  currentLang = currentLang==='ar'?'en':'ar';
  const t = translations[currentLang];
  document.getElementById('page-title').innerHTML = t.pageTitle;
  document.getElementById('latest-title').textContent = t.latest;
  document.getElementById('all-title').textContent = t.all;
  document.getElementById('th-customer').textContent = t.customer;
  document.getElementById('th-orders').textContent = t.orders;
  document.getElementById('th-total').textContent = t.total;
  document.getElementById('th-date').textContent = t.date;
  document.getElementById('th-payment').textContent = t.payment;
  document.getElementById('th-payment-status').textContent = t.paymentStatus;
  document.getElementById('th-status').textContent = t.status;
  document.getElementById('footer-text').innerHTML = t.footer;
  document.querySelector('.lang-toggle').textContent = t.button;
  renderOrders();
}

// Render Orders
function renderOrders(){
  const latestContainer = document.getElementById("latest-orders");
  const tableBody = document.getElementById("table-orders");
  latestContainer.innerHTML = "";
  tableBody.innerHTML = "";
  if(!orders.length) return;
  const sortedOrders = orders.sort((a,b)=>Date.parse(`${b.date} ${b.time}`)-Date.parse(`${a.date} ${a.time}`));
  
  // Ø£Ø­Ø¯Ø« 3
  sortedOrders.slice(0,3).forEach((order,index)=>{
    const drinks = order.drinksOrder.map(d=>`${d.drinkName} Ã—${d.quantity} ${(d.sugarChoice?'(Ù…Ø¹ Ø³ÙƒØ±)':'(Ø¨Ø¯ÙˆÙ† Ø³ÙƒØ±)')}`).join('ØŒ ');
    const div = document.createElement("div");
    div.className="order-card";
    div.innerHTML = `
      <div class="new-badge">New</div>
      <h3>${translations[currentLang].latest} #${index+1}</h3>
      <p><strong>${order.name}</strong></p>
      <p>${translations[currentLang].orders}: ${drinks}</p>
      <p>${translations[currentLang].payment}: <strong>${order.paymentMethod||'Cash'}</strong></p>
      <p>${translations[currentLang].paymentStatus}: 
        <span class="payment-badge ${order.paymentStatus}">${translations[currentLang][order.paymentStatus]}</span>
        <select class="payment-select" onchange="updatePaymentStatus('${order.id}',this.value,this)">
          <option value="paid" ${order.paymentStatus==='paid'?'selected':''}>${translations[currentLang].paid}</option>
          <option value="unpaid" ${order.paymentStatus==='unpaid'?'selected':''}>${translations[currentLang].unpaid}</option>
        </select>
      </p>
      <p class="price">${translations[currentLang].total}: ${order.total} â‚ª</p>
      <p>${translations[currentLang].date}: ${order.date} ${order.time}</p>
      <span class="status ${order.status}">${translations[currentLang][order.status]}</span>
      <button class="delete-btn" onclick="showAlert('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ØŸ','${order.id}')">Ø­Ø°Ù</button>
    `;
    latestContainer.appendChild(div);
  });

  // Ø¬Ø¯ÙˆÙ„ ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
  sortedOrders.forEach((order,index)=>{
    const drinks = order.drinksOrder.map(d=>`${d.drinkName} Ã—${d.quantity} ${(d.sugarChoice?'(Ù…Ø¹ Ø³ÙƒØ±)':'(Ø¨Ø¯ÙˆÙ† Ø³ÙƒØ±)')}`).join('ØŒ ');
    const row = document.createElement("tr");
    row.innerHTML = `
      <td><strong>#${index+1}</strong> - ${order.name}</td>
      <td>${drinks}</td>
      <td>${order.total} â‚ª</td>
      <td>${order.date} ${order.time}</td>
      <td>${order.paymentMethod||'Cash'}</td>
      <td>
        <span class="payment-badge-table ${order.paymentStatus}">${translations[currentLang][order.paymentStatus]}</span>
        <select class="payment-select" onchange="updatePaymentStatus('${order.id}',this.value,this)">
          <option value="paid" ${order.paymentStatus==='paid'?'selected':''}>${translations[currentLang].paid}</option>
          <option value="unpaid" ${order.paymentStatus==='unpaid'?'selected':''}>${translations[currentLang].unpaid}</option>
        </select>
      </td>
      <td><span class="status ${order.status}">${translations[currentLang][order.status]}</span></td>
      <td><button class="delete-btn" onclick="showAlert('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ØŸ','${order.id}')">Ø­Ø°Ù</button></td>
    `;
    tableBody.appendChild(row);
  });
}

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯ÙØ¹
function updatePaymentStatus(orderId,status,selectElement){
  db.collection("orders").doc(orderId).update({paymentStatus:status})
  .then(()=>{
    const cardBadge = selectElement.closest('.order-card')?.querySelector('.payment-badge');
    if(cardBadge) cardBadge.className=`payment-badge ${status}`, cardBadge.textContent=translations[currentLang][status];
    const tableBadge = selectElement.closest('td')?.querySelector('.payment-badge-table');
    if(tableBadge) tableBadge.className=`payment-badge-table ${status}`, tableBadge.textContent=translations[currentLang][status];
  }).catch(console.error);
}

// Firebase snapshot
db.collection("orders").onSnapshot(snapshot=>{
  orders = snapshot.docs.map(doc=>{
    const data=doc.data();
    return { id:doc.id, name:data.customerName, drinksOrder:data.drinksOrder, total:data.totalPrice, date:data.date, time:data.time, paymentMethod:data.paymentMethod||'Cash', paymentStatus:data.paymentStatus||'unpaid', status:data.status||'confirmed' };
  });
  renderOrders();
});

// ØªØµØ¯ÙŠØ± Excel
document.getElementById('exportExcelBtn').addEventListener('click', ()=>{
  const table = document.querySelector('table');
  const wb = XLSX.utils.table_to_book(table,{sheet:"Orders"});
  XLSX.writeFile(wb,'Orders.xlsx');
});

// Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
document.getElementById('deleteAllBtn').addEventListener('click', ()=>{
  showAlert("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§ØªØŸ Ù„Ù† ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹!");
  document.getElementById("confirmBtn").onclick = ()=>{
    db.collection("orders").get().then(snapshot=>{
      const batch=db.batch();
      snapshot.docs.forEach(doc=>batch.delete(doc.ref));
      return batch.commit();
    }).then(()=>{ orders=[]; renderOrders(); hideAlert(); }).catch(console.error);
  };
});
</script>
</body>
</html>


